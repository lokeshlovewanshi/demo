import com.android.build.gradle.internal.cxx.configure.gradleLocalProperties

def loadEnv(envFile) {
    def file = rootProject.file(envFile)
    def properties = new Properties()
    if (file.exists()) {
        file.withInputStream {
            properties.load(it)
        }
    }
    return properties
}

def envConfigFiles = project.hasProperty("envConfigFiles") ? project.envConfigFiles : [:]
def selectedEnvFile = envConfigFiles[project.getGradle().getStartParameter().getTaskNames().join(',')]
def env = loadEnv(selectedEnvFile)

env.each { key, value ->
    project.ext.set(key, value)
}